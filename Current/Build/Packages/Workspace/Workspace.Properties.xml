<?xml version="1.0" encoding="utf-8"?>
<project xmlns="http://nant.sf.net/schemas/nant.xsd" name="Workspace.Properties">

  <script language="C#" prefix="directory" >
    <imports>
      <import namespace="System.IO" />
    </imports>

    <code>
      <![CDATA[
         [Function("name")]
         public static string GetDirectoryName(string path)
         {
                 return new DirectoryInfo( path ).Name;
         }
      ]]>
    </code>
  </script>
  
  <strings id="Workspace.RequiredSoftware">
    <string value="VisualStudio2005"/>
    <string value="NCover"/>
    <string value="TeamExplorer"/>
    <string value="Subversion"/>
    <string value="Perforce"/>
    <string value="PerforceServer"/>
  </strings>

	<strings id="Workspace.Configuration">
		<string value="MbUnit"/>
	</strings>

	<include buildfile="Software\NCover\NCover.Script.xml"/>
  <include buildfile="Software\Perforce\Perforce.Script.xml"/>
	<include buildfile="Software\VisualStudio\VisualStudio.Script.xml"/>
	<include buildfile="Configuration\MbUnit\MbUnit.Script.xml"/>

  <fileset id="PacakgeFinder" />
  <ifnot test="${property::exists('SourceControl.PackageName')}">
    <property name="PackagePathPattern" value="${PackagesDirectory}\**\SourceControl.Target.xml"/>
    <function execute="${fileset::include-add('PacakgeFinder', PackagePathPattern)}"/>
    <property name="PackagePath" value="${fileset::get-name-at-index('PacakgeFinder', 0)}"/>
    <property name="SourceControl.PackageName" value="${directory::name(path::get-directory-name(PackagePath))}"/>
  </ifnot>

  <ifnot test="${stringlist::contains('Workspace.RequiredSoftware', SourceControl.PackageName)}">
    <function execute="${stringlist::add('Workspace.RequiredSoftware', SourceControl.PackageName)}" />
  </ifnot>
  <include buildfile="Software\${SourceControl.PackageName}\${SourceControl.PackageName}.Script.xml"
           unless="${target::exists('Workspace.RequiredSoftware.' + SourceControl.PackageName)}"/>

</project>