<?xml version="1.0" encoding="utf-8"?>
<project name="Deployment" xmlns="http://nant.sf.net/schemas/nant.xsd" basedir="Deployment">

  <property name="Deployment.WebPathRoot" value="/${ProjectName}-${ProjectCodeLineName}/Artifacts" readonly="true"/>
  
  <!--
	The following properties should be specified in the calling script.
  
  <property name="Publish.Source.File.Name" value="TraCHIIPI.tar" />
  <property name="Publish.Source.Directory.Path"	value="${ProductionDirectory}\lib" />
  <property name="Publish.Target.Directory.Path"	value="${Common.ArtifactDirectoryPath}" />
  <property name="Deployment.TargetFile"	value="${DeploymentTargetDir}\${DeploymentFileName}" />
  <property name="Deployment.FileWebPath"	value="${Deployment.WebPathRoot}/${Common.ArtifactFolderName}/${DeploymentFileName}" />
  <property name="Deployment.FileWebName"	value="${CCNetLabel} ${DeploymentFileName}" />
  
  -->
  
  <target name="Publish.File">
    <call target="Private.Publish.CopyDeploymentToPublicationDir" />
    <call target="Publish.Link" />
  </target>
  
  <target name="Publish.Link">
    <call target="Private.Publish.EchoWebFileName" />
    <call target="Publish.EchoWebFilePath" />
  </target>

  <target name="Publish.FileSilently">
    <call target="Private.Publish.CopyDeploymentToPublicationDir" />
    <call target="Publish.EchoWebPath" />
  </target>

  <target name="Publish.EchoWebPath" >
    <echo message="${Deployment.WebPathRoot}/${Common.ArtifactFolderName}" level="Info"/>
  </target>

	<target name="Deployment.EchoDeploymentArtifactPath" >
		<echo message="${Common.ArtifactDirectoryPath}" level="Info"/>
	</target>

  <target name="Private.Publish.EchoWebFileName" >
    <echo message="${Deployment.FileWebName}" level="Info"/>
  </target>
  
  <target name="Publish.EchoWebFilePath" >
    <echo message="${Deployment.FileWebPath}" level="Info"/>
  </target>

  <target name="Private.Publish.CopyDeploymentToPublicationDir" >
    <mkdir if="${directory::exists(Publish.Target.Directory.Path) == false}" dir="${Publish.Target.Directory.Path}" />
    <copy file="${Publish.Source.Directory.Path}/${Publish.Source.File.Name}" tofile="${Publish.Target.Directory.Path}/${Deployment.TargetFile}" />
  </target>

  <target name="Publish.Zip">
    <mkdir if="${directory::exists(Publish.Target.Directory.Path) == false}" dir="${Publish.Target.Directory.Path}" />
    <zip zipfile="${Publish.Target.Directory.Path}/${Deployment.ZipFileName}">
      <fileset refid="Deployment.ZipFileSet" />
    </zip>

    <call target="Publish.Link"/>
  </target>

  <target name="Deployment.SetUp">
    <call target="Publish.EchoWebPath" />
		<call target="Deployment.EchoDeploymentArtifactPath"/>
  </target>

  <target name="Deployment.TearDown">

  </target>
  
</project>